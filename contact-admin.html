<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å’¨è¯¢ç®¡ç†åå° - å¤§è¿å›å®ç®¡ç†å’¨è¯¢æœ‰é™å…¬å¸</title>
    <meta name="description" content="æŸ¥çœ‹å’Œç®¡ç†å®¢æˆ·å’¨è¯¢è¯·æ±‚çš„åå°ç³»ç»Ÿ">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft YaHei', sans-serif; line-height: 1.6; color: #333; background: #f8f9fa; }
        .container { max-width: 1400px; margin: 0 auto; padding: 0 20px; }
        
        header { background: linear-gradient(135deg, #1a237e 0%, #283593 100%); color: white; padding: 20px 0; }
        .logo { font-size: 28px; font-weight: bold; margin-bottom: 10px; }
        .logo span { color: #4fc3f7; }
        .slogan { font-size: 16px; opacity: 0.9; margin-bottom: 20px; }
        .admin-header { display: flex; justify-content: space-between; align-items: center; }
        
        .section-title { text-align: center; font-size: 32px; margin: 30px 0 20px; color: #1a237e; position: relative; }
        .section-title::after { content: ''; display: block; width: 60px; height: 3px; background: #4fc3f7; margin: 10px auto; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0; }
        .stat-card { background: white; border-radius: 10px; padding: 25px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .stat-number { font-size: 36px; color: #1a237e; font-weight: bold; margin-bottom: 10px; }
        .stat-label { font-size: 14px; color: #666; }
        
        .filter-bar { background: white; padding: 20px; border-radius: 10px; margin: 20px 0; box-shadow: 0 3px 10px rgba(0,0,0,0.05); display: flex; gap: 15px; flex-wrap: wrap; }
        .filter-group { display: flex; align-items: center; gap: 10px; }
        .filter-select, .filter-input { padding: 8px 12px; border: 1px solid #ddd; border-radius: 5px; font-family: inherit; }
        .filter-btn { background: #4fc3f7; color: white; border: none; padding: 8px 20px; border-radius: 5px; cursor: pointer; }
        .filter-btn:hover { background: #03a9f4; }
        
        .inquiries-table { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 5px 20px rgba(0,0,0,0.05); margin: 20px 0; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #e3f2fd; color: #1a237e; padding: 15px; text-align: left; font-weight: bold; }
        td { padding: 15px; border-bottom: 1px solid #eee; }
        tr:hover { background: #f8f9fa; }
        
        .status-badge { display: inline-block; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: bold; }
        .status-new { background: #d4edda; color: #155724; }
        .status-read { background: #cce5ff; color: #004085; }
        .status-contact { background: #fff3cd; color: #856404; }
        .status-closed { background: #f8d7da; color: #721c24; }
        
        .action-btn { padding: 5px 10px; border: none; border-radius: 4px; cursor: pointer; font-size: 12px; margin-right: 5px; }
        .action-view { background: #4fc3f7; color: white; }
        .action-mark { background: #28a745; color: white; }
        .action-email { background: #6f42c1; color: white; }
        .action-delete { background: #dc3545; color: white; }
        
        .detail-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .detail-content { background: white; margin: 50px auto; width: 90%; max-width: 800px; border-radius: 10px; padding: 30px; max-height: 80vh; overflow-y: auto; }
        .detail-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .detail-close { font-size: 30px; cursor: pointer; color: #999; }
        .detail-field { margin-bottom: 15px; }
        .detail-label { font-weight: bold; color: #555; margin-bottom: 5px; }
        .detail-value { background: #f8f9fa; padding: 10px; border-radius: 5px; }
        
        .export-bar { margin: 20px 0; text-align: right; }
        .export-btn { background: #28a745; color: white; border: none; padding: 10px 25px; border-radius: 5px; cursor: pointer; }
        .export-btn:hover { background: #218838; }
        
        footer { background: #0d1b2a; color: #aaa; text-align: center; padding: 40px 20px; font-size: 14px; margin-top: 50px; }
        footer p { margin: 10px 0; }
        
        @media (max-width: 768px) {
            .admin-header { flex-direction: column; align-items: flex-start; }
            .stats-grid { grid-template-columns: 1fr; }
            table { display: block; overflow-x: auto; }
            .filter-bar { flex-direction: column; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="admin-header">
                <div>
                    <div class="logo">å¤§è¿<span>å›å®</span>ç®¡ç†å’¨è¯¢</div>
                    <div class="slogan">å’¨è¯¢ç®¡ç†åå°ç³»ç»Ÿ</div>
                </div>
                <div style="color: #4fc3f7; font-size: 14px;">æœ€åæ›´æ–°ï¼š<span id="lastUpdate"></span></div>
            </div>
        </div>
    </header>

    <div class="container">
        <h1 class="section-title">å®¢æˆ·å’¨è¯¢ç®¡ç†</h1>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalInquiries">0</div>
                <div class="stat-label">æ€»å’¨è¯¢æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="newInquiries">0</div>
                <div class="stat-label">æ–°å’¨è¯¢</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="todayInquiries">0</div>
                <div class="stat-label">ä»Šæ—¥å’¨è¯¢</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="monthInquiries">0</div>
                <div class="stat-label">æœ¬æœˆå’¨è¯¢</div>
            </div>
        </div>
        
        <div class="filter-bar">
            <div class="filter-group">
                <label>çŠ¶æ€ï¼š</label>
                <select class="filter-select" id="filterStatus">
                    <option value="all">å…¨éƒ¨çŠ¶æ€</option>
                    <option value="new">æ–°å’¨è¯¢</option>
                    <option value="read">å·²è¯»</option>
                    <option value="contacted">å·²è”ç³»</option>
                    <option value="closed">å·²å…³é—­</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label>å’¨è¯¢ç±»å‹ï¼š</label>
                <select class="filter-select" id="filterService">
                    <option value="all">å…¨éƒ¨ç±»å‹</option>
                    <option value="organization">ç»„ç»‡æ¶æ„è®¾è®¡</option>
                    <option value="process">ä¸šåŠ¡æµç¨‹å†é€ </option>
                    <option value="talent">äººæ‰å‘å±•ä½“ç³»å»ºè®¾</option>
                    <option value="training">ç®¡ç†èµ‹èƒ½åŸ¹è®­</option>
                    <option value="sales">é”€å”®èµ‹èƒ½åŸ¹è®­</option>
                    <option value="digital">AIä¸æ•°å­—åŒ–è½¬å‹</option>
                    <option value="other">å…¶ä»–éœ€æ±‚</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label>æ—¥æœŸï¼š</label>
                <input type="date" class="filter-input" id="filterDateFrom">
                <span>è‡³</span>
                <input type="date" class="filter-input" id="filterDateTo">
            </div>
            
            <div class="filter-group">
                <label>å…³é”®è¯ï¼š</label>
                <input type="text" class="filter-input" id="filterKeyword" placeholder="å§“å/å…¬å¸/ç”µè¯">
            </div>
            
            <button class="filter-btn" onclick="loadInquiries()">ç­›é€‰</button>
            <button class="filter-btn" onclick="resetFilters()">é‡ç½®</button>
        </div>
        
        <div class="export-bar">
            <button class="export-btn" onclick="exportToExcel()">ğŸ“Š å¯¼å‡ºExcel</button>
            <button class="export-btn" onclick="sendEmailSummary()">ğŸ“§ å‘é€é‚®ä»¶æ±‡æ€»</button>
        </div>
        
        <div class="inquiries-table">
            <table id="inquiriesTable">
                <thead>
                    <tr>
                        <th width="5%">#</th>
                        <th width="15%">æäº¤æ—¶é—´</th>
                        <th width="10%">å§“å</th>
                        <th width="15%">å…¬å¸</th>
                        <th width="12%">ç”µè¯</th>
                        <th width="12%">å’¨è¯¢ç±»å‹</th>
                        <th width="10%">çŠ¶æ€</th>
                        <th width="21%">æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="inquiriesBody">
                    <!-- æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                </tbody>
            </table>
        </div>
        
        <div style="text-align: center; margin: 30px 0; color: #666; font-size: 14px;" id="loadingMessage">
            æ­£åœ¨åŠ è½½å’¨è¯¢æ•°æ®...
        </div>
    </div>
    
    <!-- å’¨è¯¢è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div class="detail-modal" id="detailModal">
        <div class="detail-content">
            <div class="detail-header">
                <h2>å’¨è¯¢è¯¦æƒ…</h2>
                <div class="detail-close" onclick="closeDetailModal()">Ã—</div>
            </div>
            <div id="detailContent">
                <!-- è¯¦æƒ…å†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>Â© 2014-2026 å¤§è¿å›å®ç®¡ç†å’¨è¯¢æœ‰é™å…¬å¸ ç‰ˆæƒæ‰€æœ‰</p>
            <p>åå°ç³»ç»Ÿ - ä»…ä¾›å†…éƒ¨ç®¡ç†ä½¿ç”¨</p>
            <p style="font-size: 12px; color: #4fc3f7; margin-top: 10px;">æ•°æ®å­˜å‚¨äºæµè§ˆå™¨æœ¬åœ°ï¼Œæ¸…ç©ºæµè§ˆå™¨ç¼“å­˜å°†ä¸¢å¤±æ•°æ®</p>
        </div>
    </footer>

    <script>
        // æ¨¡æ‹Ÿæ•°æ®ï¼ˆå®é™…é¡¹ç›®ä¸­åº”è¯¥ä»æœåŠ¡å™¨APIè·å–ï¼‰
        let allInquiries = [];
        
        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('lastUpdate').textContent = new Date().toLocaleString('zh-CN');
            loadInquiries();
            updateStats();
            setInterval(loadInquiries, 30000); // æ¯30ç§’åˆ·æ–°ä¸€æ¬¡
        });
        
        // åŠ è½½å’¨è¯¢æ•°æ®
        function loadInquiries() {
            const loadingMessage = document.getElementById('loadingMessage');
            loadingMessage.textContent = 'æ­£åœ¨åŠ è½½å’¨è¯¢æ•°æ®...';
            
            // ä»æœ¬åœ°å­˜å‚¨è·å–æ•°æ®
            try {
                const savedData = localStorage.getItem('junshi_inquiries');
                if (savedData) {
                    allInquiries = JSON.parse(savedData);
                } else {
                    allInquiries = [];
                }
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥ï¼š', error);
                allInquiries = [];
            }
            
            // åº”ç”¨ç­›é€‰æ¡ä»¶
            let filteredInquiries = [...allInquiries];
            
            const statusFilter = document.getElementById('filterStatus').value;
            const serviceFilter = document.getElementById('filterService').value;
            const dateFrom = document.getElementById('filterDateFrom').value;
            const dateTo = document.getElementById('filterDateTo').value;
            const keyword = document.getElementById('filterKeyword').value.toLowerCase();
            
            if (statusFilter !== 'all') {
                filteredInquiries = filteredInquiries.filter(item => item.status === getStatusText(statusFilter));
            }
            
            if (serviceFilter !== 'all') {
                filteredInquiries = filteredInquiries.filter(item => item.service === serviceFilter);
            }
            
            if (dateFrom) {
                const fromDate = new Date(dateFrom);
                filteredInquiries = filteredInquiries.filter(item => new Date(item.timestamp) >= fromDate);
            }
            
            if (dateTo) {
                const toDate = new Date(dateTo + 'T23:59:59');
                filteredInquiries = filteredInquiries.filter(item => new Date(item.timestamp) <= toDate);
            }
            
            if (keyword) {
                filteredInquiries = filteredInquiries.filter(item => 
                    item.name.toLowerCase().includes(keyword) ||
                    item.company.toLowerCase().includes(keyword) ||
                    item.phone.includes(keyword) ||
                    item.email.toLowerCase().includes(keyword)
                );
            }
            
            // æŒ‰æ—¶é—´å€’åºæ’åº
            filteredInquiries.sort((a, b) => b.id - a.id);
            
            // æ¸²æŸ“è¡¨æ ¼
            renderInquiriesTable(filteredInquiries);
            updateStats();
            
            loadingMessage.textContent = `å…± ${filteredInquiries.length} æ¡å’¨è¯¢è®°å½•`;
        }
        
        // æ¸²æŸ“è¡¨æ ¼
        function renderInquiriesTable(inquiries) {
            const tbody = document.getElementById('inquiriesBody');
            tbody.innerHTML = '';
            
            if (inquiries.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 40px; color: #999;">
                            æš‚æ— å’¨è¯¢è®°å½•
                        </td>
                    </tr>
                `;
                return;
            }
            
            inquiries.forEach((inquiry, index) => {
                const row = document.createElement('tr');
                
                // æ–°å’¨è¯¢é«˜äº®æ˜¾ç¤º
                if (inquiry.status === 'æ–°å’¨è¯¢' && !inquiry.read) {
                    row.style.backgroundColor = '#f0f8ff';
                }
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${formatDate(inquiry.timestamp)}</td>
                    <td><strong>${inquiry.name}</strong></td>
                    <td>${inquiry.company}</td>
                    <td>${inquiry.phone}</td>
                    <td>${getServiceText(inquiry.service)}</td>
                    <td><span class="status-badge status-${getStatusClass(inquiry.status)}">${inquiry.status}</span></td>
                    <td>
                        <button class="action-btn action-view" onclick="viewDetail(${inquiry.id})">æŸ¥çœ‹</button>
                        <button class="action-btn action-mark" onclick="markAsRead(${inquiry.id})">æ ‡è®°å·²è¯»</button>
                        <button class="action-btn action-email" onclick="sendEmail(${inquiry.id})">å‘é€é‚®ä»¶</button>
                        <button class="action-btn action-delete" onclick="deleteInquiry(${inquiry.id})">åˆ é™¤</button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const total = allInquiries.length;
            const newCount = allInquiries.filter(item => item.status === 'æ–°å’¨è¯¢').length;
            
            const today = new Date().toDateString();
            const todayCount = allInquiries.filter(item => 
                new Date(item.timestamp).toDateString() === today
            ).length;
            
            const thisMonth = new Date().getMonth();
            const thisYear = new Date().getFullYear();
            const monthCount = allInquiries.filter(item => {
                const itemDate = new Date(item.timestamp);
                return itemDate.getMonth() === thisMonth && itemDate.getFullYear() === thisYear;
            }).length;
            
            document.getElementById('totalInquiries').textContent = total;
            document.getElementById('newInquiries').textContent = newCount;
            document.getElementById('todayInquiries').textContent = todayCount;
            document.getElementById('monthInquiries').textContent = monthCount;
        }
        
        // æŸ¥çœ‹è¯¦æƒ…
        function viewDetail(id) {
            const inquiry = allInquiries.find(item => item.id === id);
            if (!inquiry) return;
            
            // æ ‡è®°ä¸ºå·²è¯»
            if (inquiry.status === 'æ–°å’¨è¯¢') {
                inquiry.status = 'å·²è¯»';
                inquiry.read = true;
                saveToLocalStorage();
            }
            
            const detailContent = document.getElementById('detailContent');
            detailContent.innerHTML = `
                <div class="detail-field">
                    <div class="detail-label">æäº¤æ—¶é—´</div>
                    <div class="detail-value">${inquiry.timestamp}</div>
                </div>
                <div class="detail-field">
                    <div class="detail-label">å§“å</div>
                    <div class="detail-value">${inquiry.name}</div>
                </div>
                <div class="detail-field">
                    <div class="detail-label">å…¬å¸åç§°</div>
                    <div class="detail-value">${inquiry.company}</div>
                </div>
                <div class="detail-field">
                    <div class="detail-label">è”ç³»ç”µè¯</div>
                    <div class="detail-value"><a href="tel:${inquiry.phone}">${inquiry.phone}</a></div>
                </div>
                <div class="detail-field">
                    <div class="detail-label">ç”µå­é‚®ç®±</div>
                    <div class="detail-value"><a href="mailto:${inquiry.email}">${inquiry.email}</a></div>
                </div>
                <div class="detail-field">
                    <div class="detail-label">å’¨è¯¢ç±»å‹</div>
                    <div class="detail-value">${getServiceText(inquiry.service)}</div>
                </div>
                <div class="detail-field">
                    <div class="detail-label">çŠ¶æ€</div>
                    <div class="detail-value"><span class="status-badge status-${getStatusClass(inquiry.status)}">${inquiry.status}</span></div>
                </div>
                <div class="detail-field">
                    <div class="detail-label">å’¨è¯¢éœ€æ±‚æè¿°</div>
                    <div class="detail-value" style="white-space: pre-wrap;">${inquiry.message}</div>
                </div>
                <div style="margin-top: 30px;">
                    <button class="action-btn action-email" onclick="sendEmail(${inquiry.id})" style="padding: 10px 20px; font-size: 14px;">ğŸ“§ å‘é€å›å¤é‚®ä»¶</button>
                    <button class="action-btn action-mark" onclick="updateStatus(${inquiry.id}, 'å·²è”ç³»')" style="padding: 10px 20px; font-size: 14px; margin-left: 10px;">âœ“ æ ‡è®°ä¸ºå·²è”ç³»</button>
                    <button class="action-btn" onclick="updateStatus(${inquiry.id}, 'å·²å…³é—­')" style="padding: 10px 20px; font-size: 14px; margin-left: 10px; background: #6c757d; color: white;">âœ— æ ‡è®°ä¸ºå·²å…³é—­</button>
                </div>
            `;
            
            document.getElementById('detailModal').style.display = 'block';
            loadInquiries(); // åˆ·æ–°åˆ—è¡¨
        }
        
        // å…³é—­è¯¦æƒ…æ¨¡æ€æ¡†
        function closeDetailModal() {
            document.getElementById('detailModal').style.display = 'none';
        }
        
        // æ ‡è®°ä¸ºå·²è¯»
        function markAsRead(id) {
            const inquiry = allInquiries.find(item => item.id === id);
            if (inquiry) {
                inquiry.status = 'å·²è¯»';
                inquiry.read = true;
                saveToLocalStorage();
                loadInquiries();
                alert('å·²æ ‡è®°ä¸ºå·²è¯»');
            }
        }
        
        // æ›´æ–°çŠ¶æ€
        function updateStatus(id, newStatus) {
            const inquiry = allInquiries.find(item => item.id === id);
            if (inquiry) {
                inquiry.status = newStatus;
                saveToLocalStorage();
                loadInquiries();
                alert(`å·²æ ‡è®°ä¸º${newStatus}`);
            }
        }
        
        // å‘é€é‚®ä»¶
        function sendEmail(id) {
            const inquiry = allInquiries.find(item => item.id === id);
            if (!inquiry) return;
            
            // æ„å»ºé‚®ä»¶å†…å®¹
            const subject = `å…³äº${inquiry.company}çš„å’¨è¯¢å›å¤ - å¤§è¿å›å®ç®¡ç†å’¨è¯¢`;
            const body = `å°Šæ•¬çš„${inquiry.name}å…ˆç”Ÿ/å¥³å£«ï¼š\n\næ„Ÿè°¢æ‚¨å¯¹å¤§è¿å›å®ç®¡ç†å’¨è¯¢çš„å…³æ³¨ï¼\næˆ‘ä»¬å·²ç»æ”¶åˆ°æ‚¨çš„å’¨è¯¢è¯·æ±‚ï¼š\n\nå…¬å¸åç§°ï¼š${inquiry.company}\nå’¨è¯¢ç±»å‹ï¼š${getServiceText(inquiry.service)}\néœ€æ±‚æè¿°ï¼š${inquiry.message}\n\næˆ‘ä»¬å°†åœ¨24å°æ—¶å†…å®‰æ’ä¸“å±é¡¾é—®ä¸æ‚¨è”ç³»ï¼Œ\nè¯·ä¿æŒç”µè¯${inquiry.phone}ç•…é€šã€‚\n\nå¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ä»¬ï¼š\nç”µè¯ï¼š17504288163\né‚®ç®±ï¼š7313765@qq.com\n\nç¥å•†ç¥ºï¼\nå¤§è¿å›å®ç®¡ç†å’¨è¯¢æœ‰é™å…¬å¸`;
            
            // ä½¿ç”¨mailtoé“¾æ¥
            const mailtoLink = `mailto:${inquiry.email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(mailtoLink);
            
            // æ ‡è®°ä¸ºå·²è”ç³»
            updateStatus(id, 'å·²è”ç³»');
        }
        
        // åˆ é™¤å’¨è¯¢
        function deleteInquiry(id) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡å’¨è¯¢è®°å½•å—ï¼Ÿ')) {
                allInquiries = allInquiries.filter(item => item.id !== id);
                saveToLocalStorage();
                loadInquiries();
                alert('å·²åˆ é™¤');
            }
        }
        
        // é‡ç½®ç­›é€‰æ¡ä»¶
        function resetFilters() {
            document.getElementById('filterStatus').value = 'all';
            document.getElementById('filterService').value = 'all';
            document.getElementById('filterDateFrom').value = '';
            document.getElementById('filterDateTo').value = '';
            document.getElementById('filterKeyword').value = '';
            loadInquiries();
        }
        
        // å¯¼å‡ºExcel
        function exportToExcel() {
            if (allInquiries.length === 0) {
                alert('æš‚æ— æ•°æ®å¯å¯¼å‡º');
                return;
            }
            
            // æ„å»ºCSVå†…å®¹
            let csvContent = 'data:text/csv;charset=utf-8,\ufeff';
            csvContent += 'æäº¤æ—¶é—´,å§“å,å…¬å¸,ç”µè¯,é‚®ç®±,å’¨è¯¢ç±»å‹,çŠ¶æ€,éœ€æ±‚æè¿°\n';
            
            allInquiries.forEach(inquiry => {
                const row = [
                    `"${inquiry.timestamp}"`,
                    `"${inquiry.name}"`,
                    `"${inquiry.company}"`,
                    `"${inquiry.phone}"`,
                    `"${inquiry.email}"`,
                    `"${getServiceText(inquiry.service)}"`,
                    `"${inquiry.status}"`,
                    `"${inquiry.message.replace(/"/g, '\"')}"`
                ].join(',');
                csvContent += row + '\n';
            });
            
            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', `å›å®å’¨è¯¢è®°å½•_${new Date().toISOString().slice(0,10)}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // å‘é€é‚®ä»¶æ±‡æ€»
        function sendEmailSummary() {
            if (allInquiries.length === 0) {
                alert('æš‚æ— æ•°æ®å¯æ±‡æ€»');
                return;
            }
            
            const today = new Date().toLocaleDateString('zh-CN');
            const newCount = allInquiries.filter(item => item.status === 'æ–°å’¨è¯¢').length;
            const todayCount = allInquiries.filter(item => 
                new Date(item.timestamp).toDateString() === new Date().toDateString()
            ).length;
            
            const subject = `å›å®å’¨è¯¢æ±‡æ€»æŠ¥å‘Š ${today}`;
            const body = `å›å®å’¨è¯¢æ±‡æ€»æŠ¥å‘Š\nç”Ÿæˆæ—¶é—´ï¼š${new Date().toLocaleString('zh-CN')}\n\nç»Ÿè®¡æ•°æ®ï¼š\n- æ€»å’¨è¯¢æ•°ï¼š${allInquiries.length}\n- æ–°å’¨è¯¢ï¼š${newCount}\n- ä»Šæ—¥å’¨è¯¢ï¼š${todayCount}\n\nè¯¦ç»†è®°å½•è¯·æŸ¥çœ‹é™„ä»¶CSVæ–‡ä»¶ã€‚\n\nå¤§è¿å›å®ç®¡ç†å’¨è¯¢åå°ç³»ç»Ÿ`;
            
            const mailtoLink = `mailto:7313765@qq.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(mailtoLink);
        }
        
        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
        function saveToLocalStorage() {
            try {
                localStorage.setItem('junshi_inquiries', JSON.stringify(allInquiries));
            } catch (error) {
                console.error('ä¿å­˜æ•°æ®å¤±è´¥ï¼š', error);
                alert('ä¿å­˜æ•°æ®å¤±è´¥ï¼Œå¯èƒ½å­˜å‚¨ç©ºé—´ä¸è¶³');
            }
        }
        
        // è¾…åŠ©å‡½æ•°
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleString('zh-CN', {
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        function getServiceText(serviceCode) {
            const services = {
                'organization': 'ç»„ç»‡æ¶æ„è®¾è®¡',
                'process': 'ä¸šåŠ¡æµç¨‹å†é€ ',
                'talent': 'äººæ‰å‘å±•ä½“ç³»å»ºè®¾',
                'training': 'ç®¡ç†èµ‹èƒ½åŸ¹è®­',
                'sales': 'é”€å”®èµ‹èƒ½åŸ¹è®­',
                'digital': 'AIä¸æ•°å­—åŒ–è½¬å‹',
                'other': 'å…¶ä»–éœ€æ±‚'
            };
            return services[serviceCode] || serviceCode;
        }
        
        function getStatusText(statusCode) {
            const statuses = {
                'new': 'æ–°å’¨è¯¢',
                'read': 'å·²è¯»',
                'contacted': 'å·²è”ç³»',
                'closed': 'å·²å…³é—­'
            };
            return statuses[statusCode] || statusCode;
        }
        
        function getStatusClass(status) {
            const statusClasses = {
                'æ–°å’¨è¯¢': 'new',
                'å·²è¯»': 'read',
                'å·²è”ç³»': 'contact',
                'å·²å…³é—­': 'closed'
            };
            return statusClasses[status] || 'read';
        }
        
        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        window.onclick = function(event) {
            const modal = document.getElementById('detailModal');
            if (event.target === modal) {
                closeDetailModal();
            }
        };
    </script>
</body>
</html>